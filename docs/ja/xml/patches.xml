<!-- <!DOCTYPE appendix PUBLIC "-//OASIS//DTD DocBook V4.1//EN"> -->
<appendix id="patches" xreflabel="Useful Patches and Utilities for Bugzilla">
  <title>寄贈</title>

  <para>
    <filename class="directory">$BUGZILLA_ROOT/contrib/</filename>
    ディレクトリにたくさんの非公式の Bugzilla アドオンがあります。
    この章ではこれらに関して解説します。
  </para>

  <section id="cmdline">
    <title>コマンドライン検索インターフェース</title>

    <para>
      コマンドラインから Bugzilla を検索可能な Unix ユーティリティです。
      これらは
      <filename class="directory">contrib/cmdline</filename> ディレクトリにあります。
      <filename>query.conf</filename>, <filename>buglist</filename> と 
      <filename>bugs</filename> の3ファイルで構成されています。
    </para>

    <warning>
      <para>
        これらのファイルはテンプレート化が行われる 2.16 リリースより前のもので、
        まだ更新されていません。
      </para>
    </warning>
    
    <para>
      <filename>query.conf</filename> はオプションをフィールド名や比較方法に
      対応付けるための情報です。引用付付きの名前は <quote>検索</quote> 用ですので、
      このファイルは簡単に編集できる必要があります。コメント (#) は無視されます。
      コメント行には引用付付きの <quote>オプション</quote>
      を含まないようにする必要があります。
    </para>

    <para>
      <filename>buglist</filename> は Bugzilla クエリを実行し、
      stdout に結果の HTML ページを返すシェルスクリプトです。
      短い形式のオプション (<quote>-Afoo</quote> や <quote>-Rbar</quote> など) 
      と長い形式のオプション (<quote>--assignedto=foo</quote> や 
      <quote>--reporter=bar</quote> など) の両方がサポートされています。
      オプションの先頭文字が <quote>-</quote> でない場合、
      <quote>--default=</quote> が先頭についているものと認識されます。
    </para>

    <para>
      カラムリストは COLUMNLIST 環境変数から取得されます。
      これは、buglist.cgi のバグリストで <quote>Change Columns</quote> 
      オプションにて利用可能なものと同じです。すでに Bugzilla を利用している場合は、
      あなたのクッキーを COLUMNLIST で検索して、現在の COLUMNLIST 
      設定を見ることも可能です。
    </para>

    <para>
      <filename>bugs</filename> is a simple shell script which calls
      <filename>buglist</filename> and extracts the
      bug numbers from the output. Adding the prefix
      <quote>http://bugzilla.mozilla.org/buglist.cgi?bug_id=</quote>
      turns the bug list into a working link if any bugs are found.
      Counting bugs is easy. Pipe the results through 
      <command>sed -e 's/,/ /g' | wc | awk '{printf $2 "\n"}'</command>
    </para>

    <para>
      Akkana Peck says she has good results piping 
      <filename>buglist</filename> output through 
      <command>w3m -T text/html -dump</command>
    </para>

  </section>

  <section id="cmdline-bugmail">
    <title>Command-line 'Send Unsent Bug-mail' tool</title>

    <para>
      Within the <filename class="directory">contrib</filename> directory
      exists a utility with the descriptive (if compact) name
      of <filename>sendunsentbugmail.pl</filename>. The purpose of this
      script is, simply, to send out any bug-related mail that should
      have been sent by now, but for one reason or another has not.
    </para>

    <para>
      To accomplish this task, <filename>sendunsentbugmail.pl</filename> uses
      the same mechanism as the <filename>sanitycheck.cgi</filename> script;
      it scans through the entire database looking for bugs with changes that
      were made more than 30 minutes ago, but where there is no record of
      anyone related to that bug having been sent mail. Having compiled a list,
      it then uses the standard rules to determine who gets mail, and sends it
      out.
    </para>

    <para>
      As the script runs, it indicates the bug for which it is currently
      sending mail; when it has finished, it gives a numerical count of how
      many mails were sent and how many people were excluded. (Individual
      user names are not recorded or displayed.) If the script produces
      no output, that means no unsent mail was detected.
    </para>

    <para>
      <emphasis>Usage</emphasis>: move the sendunsentbugmail.pl script
      up into the main directory, ensure it has execute permission, and run it
      from the command line (or from a cron job) with no parameters.
    </para>
  </section>

</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-always-quote-attributes:t
sgml-auto-insert-required-elements:t
sgml-balanced-tag-edit:t
sgml-exposed-tags:nil
sgml-general-insert-case:lower
sgml-indent-data:t
sgml-indent-step:2
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
sgml-minimize-attributes:nil
sgml-namecase-general:t
sgml-omittag:t
sgml-parent-document:("Bugzilla-Guide.xml" "book" "chapter")
sgml-shorttag:t
sgml-tag-region-if-active:t
End:
-->


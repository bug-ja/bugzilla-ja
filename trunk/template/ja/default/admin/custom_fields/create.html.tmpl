[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # Contributor(s): Frederic Buclin <LpSolit@gmail.com>
  #%]

[%# INTERFACE:
  # none
  #%]

[% PROCESS "global/field-descs.none.tmpl" %]

[% javascript = BLOCK %]
  [% INCLUDE "admin/custom_fields/cf-js.js.tmpl" %]
[% END %]

[% PROCESS global/header.html.tmpl
           title = "カスタムフィールドの追加"
           onload = "document.getElementById('new_bugmail').disabled = true;"
           javascript_urls = [ 'js/util.js' ]
           doc_section = "custom-fields.html#add-custom-fields"
%]

<p>
  カスタムフィールドを追加する [% terms.Bugzilla %] のインターフェースは非常に複雑です。
  [% terms.Bugzilla %] に慣れていない管理者は多くのカスタムフィールドを作りがちですが、
  それはユーザから『複雑すぎる』と言われてしまうでしょう。
  新たにカスタムフィールドを追加する前に、よく考えてください。
  その機能は [% terms.Bugzilla %] に既にあるかもしれません。
  また、単にその機能を有効にしていないだけかもしれません。
</p>

<ul>
  <li>カスタムフィールド名は標準のフィールドと区別可能なようにするために、
      "cf_" で始まる名前になります。
      もし、"cf_" をフィールド名の先頭から削除しても、自動的に付加されます。</li>
  <li>説明はフィールドを説明する非常に短いテキストで、
      ユーザインターフェースでこのフィールドのラベルに利用されます。</li>
</ul>

<form id="add_field" action="editfields.cgi" method="GET">
  <table border="0" cellspacing="0" cellpadding="5">
    <tr>
      <th align="right"><label for="name">名前:</label></th>
      <td>
        <input type="text" id="name" name="name" value="cf_" size="40" maxlength="64">
      </td>

      <th align="right">
        <label for="enter_bug">[% terms.bug %] 作成時に設定可能:</label>
      </th>
      <td>
        <input type="checkbox" id="enter_bug" name="enter_bug" value="1"
               onchange="toggleCheckbox(this, 'new_bugmail');">
      </td>
    </tr>
    <tr>
      <th align="right"><label for="desc">説明:</label></th>
      <td><input type="text" id="desc" name="desc" value="" size="40"></td>

      <th align="right">
        <label for="new_bugmail">[% terms.bugs %] 作成時に [% terms.bug %] メールに表示:</label>
      </th>
      <td><input type="checkbox" id="new_bugmail" name="new_bugmail" value="1"></td>
    </tr>
    <tr>
      <th align="right"><label for="type">型:</label></th>
      <td>
        <select id="type" name="type" onchange="onChangeType(this)">
          [% FOREACH type = field_types.keys %]
            [% NEXT IF type == constants.FIELD_TYPE_UNKNOWN %]
            <option value="[% type FILTER html %]">[% field_types.$type FILTER html %]</option>
          [% END %]
        </select>
      </td>

      <th align="right"><label for="obsolete">用済み:</label></th>
      <td><input type="checkbox" id="obsolete" name="obsolete" value="1"></td>
    </tr>
    <tr>
      <th align="right"><label for="sortkey">ソート順:</label></th>
      <td>
        <input type="text" id="sortkey" name="sortkey" size="6" maxlength="6">
      </td>

      <th align="right">
        <label for="visibility_field_id">特定の条件下でのみ利用可能なフィールド:</label>
      </th>
      <td>
        <select name="visibility_field_id" id="visibility_field_id"
                onchange="onChangeVisibilityField()">
          <option></option>
          [% FOREACH sel_field = Bugzilla.get_fields({ is_select => 1 }) %]
            <option value="[% sel_field.id FILTER html %]">
              [% sel_field.description FILTER html %]
              ([% sel_field.name FILTER html %])
            </option>
          [% END %]
        </select>
        <label for="visibility_value_id"><strong>設定対象:</strong></label>
        <select name="visibility_value_id" id="visibility_value_id">
          <option value=""></option>
        </select>
      </td>
    </tr>

    <tr>
      <td colspan="2">&nbsp;</td>
      <th>
        <label for="value_field_id">
          このフィールドに出現する<br>
          値を決定するためのフィールド :
        </label>
      </th>

      <td>
        <select disabled="disabled" name="value_field_id" id="value_field_id">
          <option></option>
          [% FOREACH sel_field = Bugzilla.get_fields({ is_select => 1 }) %]
            <option value="[% sel_field.id FILTER html %]">
              [% sel_field.description FILTER html %]
              ([% sel_field.name FILTER html %])
            </option>
          [% END %]
        </select>
      </td>
    </tr>
  </table>
  <p>
    <input type="hidden" name="action" value="new">
    <input type="hidden" name="token" value="[% token FILTER html %]">
    <input type="submit" id="create" value="作成">
  </p>
</form>

<p>
  <a href="editfields.cgi">カスタムフィールドの一覧に戻る</a>
</p>

[% PROCESS global/footer.html.tmpl %]
